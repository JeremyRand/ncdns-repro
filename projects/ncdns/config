#version: 0.0.9
# Using latest master branch because we need the stream isolation feature.
# Once it's in a tagged release, we'll go back to using a version number here.
version: '[% c("abbrev") %]'
git_url: https://github.com/namecoin/ncdns.git
# Using latest master branch because we need the stream isolation feature.
# Once it's in a tagged release, we'll go back to using a hash that corresponds
# to a tag here.
git_hash: '1e2eea58c79686eea47de873580bcd907ca67d80'
filename: '[% project %]-[% c("version") %]-[% c("var/osname") %]-[% c("var/build_id") %].tar.gz'

var:
  container:
    use_container: 1
  go_lib_deps:
    - gogroupcache
    - godegoutils
    - godexlogconfig
    - goncbtcjsontypes
    - gobtcjson
    - gopretty
    - godns
    - gotlsrestrictnss
    - gox509signaturesplice
    - gomadns
    - goeasyconfig
    - goservice
    - goxnet
  go_lib_no_output: 1

targets:
  linux:
    var:
      cgo: 1
  linux-i686:
    var:
      arch_deps:
        - libcap-dev:i386
  linux-x86_64:
    var:
      arch_deps:
        - libcap-dev
  osx-x86_64:
    var:
      cgo: 0
  windows:
    var:
      go_lib_deps:
        - gogroupcache
        - godegoutils
        - godexlogconfig
        - goncbtcjsontypes
        - gobtcjson
        - gopretty
        - godns
        - gotlsrestrictnss
        - gox509signaturesplice
        - gomadns
        - goeasyconfig
        - goservice
        - goxnet
        - goxsys
      cgo: 0

input_files:
  - project: container-image
  - name: go
    project: go
  - name: '[% c("var/compiler") %]'
    project: '[% c("var/compiler") %]'
    enable: '[% c("var/cgo") %]'
  - name: binutils
    project: binutils
    enable: '[% c("var/linux") && c("var/cgo") %]'
  - name: goxlog
    project: goxlog
  - name: godexlogconfig
    project: godexlogconfig
  - name: goeasyconfig
    project: goeasyconfig
  - name: goservice
    project: goservice
  - name: gogroupcache
    project: gogroupcache
  - name: goncbtcjsontypes
    project: goncbtcjsontypes
  - name: gobtcjson
    project: gobtcjson
  - name: godns
    project: godns
  - name: gotlsrestrictnss
    project: gotlsrestrictnss
  - name: gox509signaturesplice
    project: gox509signaturesplice
  - name: gomadns
    project: gomadns
  - name: gopretty
    project: gopretty
  - name: godegoutils
    project: godegoutils
  - name: goxnet
    project: goxnet
  - name: goxsys
    project: goxsys
    enable: '[% c("var/windows") %]'
